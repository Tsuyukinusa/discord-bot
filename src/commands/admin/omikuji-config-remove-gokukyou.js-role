import { SlashCommandBuilder } from "discord.js";
import { readGuildDB, writeGuildDB } from "../../utils/file.js";

export default {
    data: new SlashCommandBuilder()
        .setName("omikuji-config-remove-gokukyou-role")
        .setDescription("æ¥µå‡¶ãƒ­ãƒ¼ãƒ«è¨­å®šã‚’å‰Šé™¤ã—ã¾ã™ï¼ˆç®¡ç†è€…å°‚ç”¨ï¼‰")
        .addIntegerOption(opt =>
            opt.setName("count")
                .setDescription("æ¥µå‡¶ã‚’å¼•ã„ãŸå›æ•°")
                .setRequired(true)
                .setMinValue(1)
        ),

    async execute(interaction) {
        const guildId = interaction.guild.id;
        const count = interaction.options.getInteger("count");

        const db = await readGuildDB();
        if (!db[guildId] || !db[guildId].omikujiConfig)
            return interaction.reply("âŒ è¨­å®šãŒã‚ã‚Šã¾ã›ã‚“ã€‚");

        if (!db[guildId].omikujiConfig.gokukyouRoleRewards[count])
            return interaction.reply("âŒ ãã®å›æ•°ã®ãƒ­ãƒ¼ãƒ«è¨­å®šã¯ã‚ã‚Šã¾ã›ã‚“ã€‚");

        delete db[guildId].omikujiConfig.gokukyouRoleRewards[count];

        await writeGuildDB(db);

        return interaction.reply(
            `ğŸ—‘ï¸ æ¥µå‡¶ **${count}å›** ã®ãƒ­ãƒ¼ãƒ«è¨­å®šã‚’å‰Šé™¤ã—ã¾ã—ãŸã€‚`
        );
    }
};
